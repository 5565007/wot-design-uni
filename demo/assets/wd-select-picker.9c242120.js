import{d as e,r as l,v as a,q as o,N as t,a5 as s,h as d,j as u,o as r,c as i,w as c,a as n,z as p,n as f,u as m,x as y,e as b,F as v,b as h,t as k,p as _,f as w,i as g,g as x,a3 as C,y as V}from"./index-5b39df8e.js";import{z as $,B,k as K,b as z,o as j,F,j as I,i as S,h as q,t as A,a as M}from"./page-wraper.5f136bdc.js";import{_ as O}from"./wd-search.a5502906.js";import{_ as T,a as L}from"./wd-checkbox-group.70dbb183.js";import{_ as P,a as U}from"./wd-radio-group.6d7be646.js";import{_ as W}from"./wd-button.666a7a8c.js";import{_ as D}from"./wd-action-sheet.676acb18.js";import{u as R}from"./useTranslate.58e1bf0a.js";const E=M(e({name:"wd-select-picker",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{customClass:{default:""},customContentClass:{default:""},customLabelClass:{default:""},customValueClass:{default:""},label:null,labelWidth:{default:"33%"},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},placeholder:null,title:null,alignRight:{type:Boolean,default:!1},error:{type:Boolean,default:!1},required:{type:Boolean,default:!1},useLabelSlot:{type:Boolean,default:!1},useDefaultSlot:{type:Boolean,default:!1},size:null,checkedColor:null,min:{default:0},max:{default:0},selectSize:null,loading:{type:Boolean,default:!1},loadingColor:{default:"#4D80F0"},closeOnClickModal:{type:Boolean,default:!0},modelValue:{type:[Array,Number,Boolean,String]},columns:{default:()=>[]},type:{default:"checkbox"},valueKey:{default:"value"},labelKey:{default:"label"},confirmButtonText:null,displayFormat:null,beforeConfirm:null,zIndex:{default:15},safeAreaInsetBottom:{type:Boolean,default:!0},filterable:{type:Boolean,default:!1},filterPlaceholder:null,ellipsis:{type:Boolean,default:!1},scrollIntoView:{type:Boolean,default:!0},prop:null,rules:{default:()=>[]}},emits:["change","cancel","confirm","update:modelValue"],setup(e,{expose:M,emit:E}){const G=e,{translate:N}=R("select-picker"),H=l(!1),J=l([]),Q=l(!1),X=l([]),Y=l(""),Z=l([]),ee=l(0),le=$(),ae=a((()=>{const e=ie(G.modelValue);let l="";if(G.displayFormat)l=G.displayFormat(e,G.columns);else{const{type:a,labelKey:o}=G;if("checkbox"===a){l=e.map((e=>re(e))).map((e=>e[o])).join(", ")}else if("radio"===a){l=re(e)[o]}else l=e}return l}));o((()=>G.modelValue),(e=>{e!==J.value&&(J.value=ie(e),X.value=ie(e))}),{deep:!0,immediate:!0}),o((()=>G.columns),(e=>{G.filterable&&Y.value?ve(e,Y.value):Z.value=e}),{deep:!0,immediate:!0}),o((()=>G.displayFormat),(e=>{e&&"function"!==B(e)&&console.error("The type of displayFormat must be Function")}),{deep:!0,immediate:!0}),o((()=>G.beforeConfirm),(e=>{e&&"function"!==B(e)&&console.error("The type of beforeConfirm must be Function")}),{deep:!0,immediate:!0});const{parent:oe}=K(F),te=a((()=>oe&&G.prop&&oe.errorMessages&&oe.errorMessages[G.prop]?oe.errorMessages[G.prop]:"")),se=a((()=>{let e=!1;if(oe&&oe.props.rules){const l=oe.props.rules;for(const a in l)Object.prototype.hasOwnProperty.call(l,a)&&a===G.prop&&Array.isArray(l[a])&&(e=l[a].some((e=>e.required)))}return G.required||G.rules.some((e=>e.required))||e}));t((()=>{J.value=ie(G.modelValue),Z.value=G.columns}));const{proxy:de}=V();function ue(){}function re(e){const{valueKey:l,labelKey:a,columns:o}=G,t=o.filter((a=>a[l]===e));return t.length>0?t[0]:{[l]:e,[a]:""}}function ie(e){return"checkbox"===G.type?Array.prototype.slice.call(e):e}function ce({value:e}){J.value=e,E("change",{value:e})}function ne(){H.value=!1,Q.value||(J.value=ie(X.value)),E("cancel")}function pe(){G.disabled||G.readonly||(J.value=ie(G.modelValue),H.value=!0,Q.value=!1)}function fe(){if(G.loading)return H.value=!1,void E("confirm");G.beforeConfirm?G.beforeConfirm(J.value,(e=>{e&&me()})):me()}function me(){Q.value=!0,H.value=!1,X.value=ie(J.value);let e={};e="checkbox"===G.type?X.value.map((e=>re(e))):re(X.value),E("update:modelValue",X.value),E("confirm",{value:X.value,selectedItems:e})}function ye(e,l){const a=new RegExp(`(${l})`,"g");return e.split(a).map((e=>({type:e===l?"active":"normal",label:e})))}function be({value:e}){""===e?(Z.value=[],Y.value=e,s((()=>{Z.value=G.columns}))):(Y.value=e,ve(G.columns,e))}function ve(e,l){const a=e.filter((e=>e[G.labelKey].indexOf(l)>-1)).map((e=>({...e,[G.labelKey]:ye(e[G.labelKey],l)})));Z.value=[],s((()=>{Z.value=a}))}return M({close:ne,open:pe}),(l,a)=>{const o=g,t=d(u("wd-icon"),z),V=d(u("wd-search"),O),$=x,B=d(u("wd-checkbox"),T),K=d(u("wd-checkbox-group"),L),F=d(u("wd-radio"),P),M=d(u("wd-radio-group"),U),R=d(u("wd-loading"),j),E=C,G=d(u("wd-button"),W),Q=d(u("wd-action-sheet"),D);return r(),i(o,{class:f(`wd-select-picker ${m(le).border.value?"is-border":""} ${e.customClass}`)},{default:c((()=>[n(o,{class:"wd-select-picker__field",onClick:pe},{default:c((()=>[e.useDefaultSlot?p(l.$slots,"default",{key:0},void 0,!0):(r(),i(o,{key:1,class:f(`wd-select-picker__cell ${e.disabled&&"is-disabled"} ${e.readonly&&"is-readonly"} ${e.alignRight&&"is-align-right"} ${e.error&&"is-error"} ${e.size&&"is-"+e.size}`)},{default:c((()=>[e.label||e.useLabelSlot?(r(),i(o,{key:0,class:f(`wd-select-picker__label ${m(se)&&"is-required"} ${e.customLabelClass}`),style:y(e.labelWidth?"min-width:"+e.labelWidth+";max-width:"+e.labelWidth+";":"")},{default:c((()=>[e.label?(r(),b(v,{key:0},[h(k(e.label),1)],64)):p(l.$slots,"label",{key:1},void 0,!0)])),_:3},8,["class","style"])):_("",!0),n(o,{class:"wd-select-picker__body"},{default:c((()=>[n(o,{class:"wd-select-picker__value-wraper"},{default:c((()=>[n(o,{class:f(`wd-select-picker__value ${e.ellipsis&&"is-ellipsis"} ${e.customValueClass} ${m(ae)?"":"wd-select-picker__value--placeholder"}`)},{default:c((()=>[h(k(m(ae)||e.placeholder||m(N)("placeholder")),1)])),_:1},8,["class"]),e.disabled||e.readonly?_("",!0):(r(),i(t,{key:0,"custom-class":"wd-select-picker__arrow",name:"arrow-right"}))])),_:1}),m(te)?(r(),i(o,{key:0,class:"wd-select-picker__error-message"},{default:c((()=>[h(k(m(te)),1)])),_:1})):_("",!0)])),_:1})])),_:3},8,["class"]))])),_:3}),n(Q,{modelValue:H.value,"onUpdate:modelValue":a[3]||(a[3]=e=>H.value=e),duration:250,title:e.title||m(N)("title"),"close-on-click-modal":e.closeOnClickModal,"z-index":e.zIndex,"safe-area-inset-bottom":e.safeAreaInsetBottom,onClose:ne,onOpened:a[4]||(a[4]=l=>e.scrollIntoView?function(){let e="",l=[];I(J.value)&&!S(J.value)?(e="#wd-radio-group",l=[q(`#radio${J.value}`,!1,de)]):S(J.value)&&J.value.length>0&&(J.value.forEach((e=>{l.push(q(`#check${e}`,!1,de))})),e="#wd-checkbox-group"),e&&A().then((()=>{A().then((()=>{Promise.all([q(".wd-select-picker__wrapper",!1,de),q(e,!1,de),...l]).then((e=>{if(I(e)&&S(e)){const l=e[0],a=e[1],o=e.slice(2)||[];I(a)&&I(l)&&o.findIndex((e=>e.top>=l.top&&e.bottom<=l.bottom))<0&&(ee.value=-1,s((()=>{ee.value=Math.max(0,o[0].top-a.top-l.height/2)})))}})).catch((e=>{console.log(e)}))}))}))}():""),"custom-header-class":"wd-select-picker__header"},{default:c((()=>[e.filterable?(r(),i(V,{key:0,modelValue:Y.value,"onUpdate:modelValue":a[0]||(a[0]=e=>Y.value=e),placeholder:e.filterPlaceholder||m(N)("filterPlaceholder"),"hide-cancel":"","placeholder-left":"",onChange:be},null,8,["modelValue","placeholder"])):_("",!0),n(E,{class:f(`wd-select-picker__wrapper ${e.filterable?"is-filterable":""} ${e.loading?"is-loading":""} ${e.customContentClass}`),"scroll-y":!e.loading,"scroll-top":ee.value,"scroll-with-animation":!0},{default:c((()=>["checkbox"===e.type?(r(),i(o,{key:0,id:"wd-checkbox-group"},{default:c((()=>[n(K,{modelValue:J.value,"onUpdate:modelValue":a[1]||(a[1]=e=>J.value=e),cell:"",size:e.selectSize,"checked-color":e.checkedColor,min:e.min,max:e.max,onChange:ce},{default:c((()=>[(r(!0),b(v,null,w(Z.value,(l=>(r(),i(o,{key:l[e.valueKey],id:"check"+l[e.valueKey]},{default:c((()=>[n(B,{modelValue:l[e.valueKey],disabled:l.disabled},{default:c((()=>[e.filterable&&Y.value?(r(!0),b(v,{key:0},w(l[e.labelKey],(e=>(r(),b(v,{key:e.label},["active"===e.type?(r(),i($,{key:0,class:"wd-select-picker__text-active"},{default:c((()=>[h(k(e.label),1)])),_:2},1024)):(r(),b(v,{key:1},[h(k(e.label),1)],64))],64)))),128)):(r(),b(v,{key:1},[h(k(l[e.labelKey]),1)],64))])),_:2},1032,["modelValue","disabled"])])),_:2},1032,["id"])))),128))])),_:1},8,["modelValue","size","checked-color","min","max"])])),_:1})):_("",!0),"radio"===e.type?(r(),i(o,{key:1,id:"wd-radio-group"},{default:c((()=>[n(M,{modelValue:J.value,"onUpdate:modelValue":a[2]||(a[2]=e=>J.value=e),cell:"",size:e.selectSize,"checked-color":e.checkedColor,onChange:ce},{default:c((()=>[(r(!0),b(v,null,w(Z.value,((l,a)=>(r(),i(o,{key:a,id:"radio"+l[e.valueKey]},{default:c((()=>[n(F,{value:l[e.valueKey],disabled:l.disabled},{default:c((()=>[e.filterable&&Y.value?(r(!0),b(v,{key:0},w(l[e.labelKey],(e=>(r(),i($,{key:e.label,clsss:""+("active"===e.type?"wd-select-picker__text-active":"")},{default:c((()=>[h(k(e.label),1)])),_:2},1032,["clsss"])))),128)):(r(),b(v,{key:1},[h(k(l[e.labelKey]),1)],64))])),_:2},1032,["value","disabled"])])),_:2},1032,["id"])))),128))])),_:1},8,["modelValue","size","checked-color"])])),_:1})):_("",!0),e.loading?(r(),i(o,{key:2,class:"wd-select-picker__loading",onTouchmove:ue},{default:c((()=>[n(R,{color:e.loadingColor},null,8,["color"])])),_:1})):_("",!0)])),_:1},8,["class","scroll-y","scroll-top"]),n(o,{class:"wd-select-picker__footer"},{default:c((()=>[n(G,{block:"",size:"large",onClick:fe,disabled:e.loading},{default:c((()=>[h(k(e.confirmButtonText||m(N)("confirm")),1)])),_:1},8,["disabled"])])),_:1})])),_:1},8,["modelValue","title","close-on-click-modal","z-index","safe-area-inset-bottom"])])),_:3},8,["class"])}}}),[["__scopeId","data-v-ff4bba2e"]]);export{E as _};
