import{d as e,r as t,P as s,v as a,h as o,j as l,o as u,c as i,w as n,a as d,n as v,x as r,u as c,z as f,i as p,y as h,a4 as b,O as y,N as w}from"./index-5b39df8e.js";import{_ as m}from"./wd-resize.3750aa3a.js";import{g as x,r as $,p as g,h as _,a as C}from"./page-wraper.5f136bdc.js";const z=C(e({name:"wd-sticky",options:{addGlobalClass:!0,styleIsolation:"shared"},props:{customStyle:{default:""},customClass:{default:""},zIndex:{default:1},offsetTop:{default:0}},setup(e,{expose:y}){const w=e,C=t(`wd-sticky${x()}`),z=t(!1),k=t("absolute"),T=t(0),I=t(0),R=t(0),P=t([]),j=t(""),M=s("box-height",null)||t(0),B=s("observerForChild",null),{proxy:F}=h(),G=h(),S=a((()=>{const e={"z-index":w.zIndex,height:$(I.value),width:$(R.value)};return z.value||(e.position="relative"),`${g(e)};${w.customStyle}`})),V=a((()=>{const e={"z-index":w.zIndex,height:$(I.value),width:$(R.value)};return z.value||(e.position="relative"),`${g(e)};`})),E=a((()=>{const e={position:k.value,top:$(T.value)};return g(e)})),N=a((()=>{let e=0;return e=44,44+w.offsetTop}));function O(e){R.value=e.width,I.value=e.height,function(){if(0===I.value&&0===R.value)return;const e=N.value+I.value;(function(){for(;0!==P.value.length;)P.value.pop().disconnect()})(),function(){const e=b(G);return P.value.push(e),e}().relativeToViewport({top:-e}).observe(`#${C.value}`,q),_(`#${C.value}`,!1,F).then((t=>{t.bottom<=e&&q({boundingClientRect:t})}))}(),B&&B(F)}function q({boundingClientRect:e}){if(B&&I.value>=M.value)return k.value="absolute",void(T.value=0);e.top<=N.value?(j.value="sticky",z.value=!1,k.value="fixed",T.value=N.value):e.top>N.value&&(j.value="normal",z.value=!1,k.value="absolute",T.value=0)}return y({setPosition:function(e,t,s){z.value=e,k.value=t,T.value=s},openBox:z,position:k,top:T,height:I,width:R,state:j,offsetTop:N.value}),(e,t)=>{const s=o(l("wd-resize"),m),a=p;return u(),i(a,{style:r(`${c(S)};display: inline-block;`)},{default:n((()=>[d(a,{class:v(`wd-sticky ${w.customClass}`),style:r(c(V)),id:C.value},{default:n((()=>[d(a,{class:"wd-sticky__container",style:r(c(E))},{default:n((()=>[d(s,{onResize:O,"custom-style":"display: inline-block;"},{default:n((()=>[f(e.$slots,"default",{},void 0,!0)])),_:3})])),_:3},8,["style"])])),_:3},8,["class","style","id"])])),_:3},8,["style"])}}}),[["__scopeId","data-v-790bad3e"]]),k=C(e({name:"wd-sticky-box",options:{addGlobalClass:!0,styleIsolation:"shared"},props:{customClass:{default:""}},setup(e){const s=e,a=t(`wd-sticky-box${x()}`),r=t(new Map),c=t(0),$=t(0),g=[],{proxy:C}=h(),z=h();function k(e){$.value=e.width,c.value=e.height;const t=r.value;r.value=new Map;for(const[s]of t){T(g.find((e=>e.$.uid===s)))}t.forEach((e=>{e.disconnect()})),t.clear()}function T(e){g.find((t=>t.$.uid===e.$.uid))||g.push(e),function(e){const t=r.value.get(e.$.uid);t&&(t.disconnect(),r.value.delete(e.$.uid))}(e);const t=function(e){const t=b(z);return r.value.set(e.$.uid,t),t}(e),s=e.$.exposed,o=s.height.value+s.offsetTop;c.value<=s.height.value&&s.setPosition(!1,"absolute",0),t.relativeToViewport({top:-o}).observe(`#${a.value}`,(e=>{I(s,e)})),_(`#${a.value}`,!1,C).then((e=>{e.bottom<=o&&I(s,{boundingClientRect:e})}))}function I(e,{boundingClientRect:t}){const s=e.height.value+e.offsetTop;if(t.bottom<=s)e.setPosition(!0,"absolute",t.height-e.height.value);else if(t.top<=s&&t.bottom>s){if("normal"===e.state.value)return;e.setPosition(!1,"fixed",e.offsetTop)}}return y("box-height",c),y("box-width",$),y("observerForChild",T),w((()=>{r.value=new Map})),(e,t)=>{const r=o(l("wd-resize"),m),c=p;return u(),i(c,{style:{position:"relative"}},{default:n((()=>[d(c,{class:v(`wd-sticky-box ${s.customClass}`),id:a.value},{default:n((()=>[d(r,{onResize:k},{default:n((()=>[f(e.$slots,"default",{},void 0,!0)])),_:3})])),_:3},8,["class","id"])])),_:3})}}}),[["__scopeId","data-v-ff77a7e4"]]);export{z as _,k as a};
