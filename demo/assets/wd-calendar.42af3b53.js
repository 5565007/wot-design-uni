import{d as e,r as a,q as l,v as t,o as n,c as s,w as r,n as o,u as d,i as u,a as i,z as c,x as m,e as f,b as p,t as w,F as h,p as v,f as y,h as g,j as _}from"./index-5b39df8e.js";import{z as k,k as b,D as Y,E as D,i as x,b as C,M as $,F as M,a as F}from"./page-wraper.5f136bdc.js";import{_ as T,a as V}from"./wd-tabs.a54d3bd4.js";import{_ as S}from"./wd-tag.2e86503e.js";import{i as B,_ as O,d as j,g as W}from"./wd-calendar-view.123cba71.js";import{_ as z}from"./wd-button.666a7a8c.js";import{_ as I}from"./wd-action-sheet.676acb18.js";import{u as q}from"./useTranslate.58e1bf0a.js";const A=F(e({name:"wd-calendar",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{customClass:{default:""},customViewClass:{default:""},customLabelClass:{default:""},customValueClass:{default:""},modelValue:null,type:{default:"date"},minDate:{default:new Date((new Date).getFullYear(),(new Date).getMonth()-6,(new Date).getDate()).getTime()},maxDate:{default:new Date((new Date).getFullYear(),(new Date).getMonth()+6,(new Date).getDate(),23,59,59).getTime()},firstDayOfWeek:{default:0},formatter:null,maxRange:null,rangePrompt:null,allowSameDay:{type:Boolean,default:!1},defaultTime:null,timeFilter:null,hideSecond:{type:Boolean,default:!1},label:null,labelWidth:null,useLabelSlot:{type:Boolean,default:!1},useDefaultSlot:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},placeholder:null,title:null,alignRight:{type:Boolean,default:!1},error:{type:Boolean,default:!1},required:{type:Boolean,default:!1},size:null,center:{type:Boolean,default:!1},closeOnClickModal:{type:Boolean,default:!0},zIndex:{default:15},showConfirm:{type:Boolean,default:!0},confirmText:null,displayFormat:null,innerDisplayFormat:null,ellipsis:{type:Boolean,default:!1},showTypeSwitch:{type:Boolean,default:!1},shortcuts:{default:()=>[]},onShortcutsClick:null,safeAreaInsetBottom:{type:Boolean,default:!0},beforeConfirm:null,prop:null,rules:{default:()=>[]}},emits:["cancel","change","update:modelValue","confirm"],setup(e,{emit:F}){const A=e,{translate:L}=q("calendar"),R=(e,a)=>{switch(a){case"date":return j(e).format("YYYY-MM-DD");case"dates":return e.map((e=>j(e).format("YYYY-MM-DD"))).join(", ");case"daterange":return`${e[0]?j(e[0]).format("YYYY-MM-DD"):L("startTime")} ${L("to")} ${e[1]?j(e[1]).format("YYYY-MM-DD"):L("endTime")}`;case"datetime":return j(e).format("YYYY-MM-DD HH:mm:ss");case"datetimerange":return`${e[0]?j(e[0]).format(L("timeFormat")):L("startTime")} ${L("to")}\n${e[1]?j(e[1]).format(L("timeFormat")):L("endTime")}`;case"week":{const a=new Date(e).getFullYear(),l=W(e);return L("weekFormat",a,$(l))}case"weekrange":{const a=new Date(e[0]).getFullYear(),l=W(e[0]),t=new Date(e[1]).getFullYear(),n=W(e[1]);return`${e[0]?L("weekFormat",a,$(l)):L("startWeek")} - ${e[1]?L("weekFormat",t,$(n)):L("endWeek")}`}case"month":return j(e).format("YYYY / MM");case"monthrange":return`${e[0]?j(e[0]).format("YYYY / MM"):L("startMonth")} ${L("to")} ${e[1]?j(e[1]).format("YYYY / MM"):L("endMonth")}`}},H=(e,a,l)=>{switch(l){case"daterange":return e?j(e).format(L("dateFormat")):L("end"===a?"endTime":"startTime");case"datetimerange":return e?j(e).format(L("timeFormat")):L("end"===a?"endTime":"startTime");case"weekrange":{if(!e)return L("end"===a?"endWeek":"startWeek");const l=new Date(e).getFullYear(),t=W(e);return L("weekFormat",l,$(t))}case"monthrange":return e?j(e).format(L("monthFormat")):L("end"===a?"endMonth":"startMonth")}},P=a(!1),U=a(null),G=a(null),E=a(338),J=a(!0),Q=a(""),K=a(0),N=a(0),X=a("date"),Z=a("date"),ee=a(!1),ae=a([]),le=k(),te=a(),ne=a();l((()=>A.modelValue),((e,a)=>{Y(e,a)||(U.value=D(e),J.value=fe(e),ye(),A.type.indexOf("range")>-1&&ve())}),{immediate:!0}),l((()=>A.type),((e,a)=>{if(A.showTypeSwitch){const a=["date","week","month"],l=["daterange","weekrange","monthrange"],t=e.indexOf("range")>-1?l.indexOf(e)||0:a.indexOf(e);K.value=t}E.value=A.showConfirm?338:400,X.value=D(e),ye(),A.type.indexOf("range")>-1&&ve()}),{deep:!0,immediate:!0}),l((()=>A.showConfirm),(e=>{E.value=e?338:400}),{deep:!0,immediate:!0});const{parent:se}=b(M),re=t((()=>se&&A.prop&&se.errorMessages&&se.errorMessages[A.prop]?se.errorMessages[A.prop]:"")),oe=t((()=>{let e=!1;if(se&&se.props.rules){const a=se.props.rules;for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&l===A.prop&&Array.isArray(a[l])&&(e=a[l].some((e=>e.required)))}return A.required||A.rules.some((e=>e.required))||e})),de=t((()=>e=>B(e)));function ue(){te.value&&te.value&&te.value.$.exposed.scrollIntoView()}function ie(){const{disabled:e,readonly:a}=A;e||a||(ee.value=!0,P.value=!0,G.value=D(U.value),N.value=K.value,Z.value=X.value,ue(),setTimeout((()=>{A.showTypeSwitch&&(ne.value.scrollIntoView(),ne.value.updateLineStyle(!1))}),250))}function ce(){P.value=!1,ue(),setTimeout((()=>{U.value=D(G.value),K.value=N.value,X.value=Z.value,J.value=fe(G.value)}),250),F("cancel")}function me({index:e}){const a=A.type.indexOf("range")>-1?["daterange","weekrange","monthrange"][e]:["date","week","month"][e];K.value=e,X.value=a}function fe(e){let a=!1;return(!(A.type.indexOf("range")>-1)||e[0]&&e[1]&&e)&&("dates"!==A.type||0!==e.length&&e)&&e||(a=!0),a}function pe({value:e}){U.value=D(e),J.value=fe(e),F("change",{value:e}),A.type.indexOf("range")>-1&&ve(),A.showConfirm||J.value||we()}function we(){A.beforeConfirm?A.beforeConfirm({value:U.value,resolve:e=>{e&&he()}}):he()}function he(){P.value=!1,F("update:modelValue",U.value),F("confirm",{value:U.value}),ye()}function ve(){const[e,a]=D(x(U.value)?U.value:[]);ae.value=[e,a].map(((e,a)=>(A.innerDisplayFormat||H)(e,0===a?"start":"end",X.value)))}function ye(){!(U.value instanceof Array)&&U.value||U.value instanceof Array&&U.value.length?Q.value=(A.displayFormat||R)(U.value,X.value):Q.value=""}return(a,l)=>{const t=u,k=g(_("wd-icon"),C),b=g(_("wd-tab"),T),Y=g(_("wd-tabs"),V),x=g(_("wd-tag"),S),$=g(_("wd-calendar-view"),O),M=g(_("wd-button"),z),F=g(_("wd-action-sheet"),I);return n(),s(t,{class:o(`wd-calendar ${d(le).border.value?"is-border":""} ${e.customClass}`)},{default:r((()=>[i(t,{class:"wd-calendar__field",onClick:ie},{default:r((()=>[e.useDefaultSlot?c(a.$slots,"default",{key:0},void 0,!0):(n(),s(t,{key:1,class:o(`wd-calendar__cell ${e.disabled?"is-disabled":""} ${e.readonly?"is-readonly":""} ${e.alignRight?"is-align-right":""} ${e.error?"is-error":""} ${e.size?"is-"+e.size:""} ${e.center?"is-center":""}`)},{default:r((()=>[e.label||e.useLabelSlot?(n(),s(t,{key:0,class:o(`wd-calendar__label ${d(oe)?"is-required":""} ${e.customLabelClass}`),style:m(e.labelWidth?"min-width:"+e.labelWidth+";max-width:"+e.labelWidth+";":"")},{default:r((()=>[e.label?(n(),f(h,{key:0},[p(w(e.label),1)],64)):c(a.$slots,"label",{key:1},void 0,!0)])),_:3},8,["class","style"])):v("",!0),i(t,{class:"wd-calendar__body"},{default:r((()=>[i(t,{class:"wd-calendar__value-wraper"},{default:r((()=>[i(t,{class:o(`wd-calendar__value ${e.ellipsis?"is-ellipsis":""} ${e.customValueClass} ${Q.value?"":"wd-calendar__value--placeholder"}`)},{default:r((()=>[p(w(Q.value||e.placeholder||d(L)("placeholder")),1)])),_:1},8,["class"]),e.disabled||e.readonly?v("",!0):(n(),s(k,{key:0,"custom-class":"wd-calendar__arrow",name:"arrow-right"}))])),_:1}),d(re)?(n(),s(t,{key:0,class:"wd-calendar__error-message"},{default:r((()=>[p(w(d(re)),1)])),_:1})):v("",!0)])),_:1})])),_:3},8,["class"]))])),_:3}),i(F,{modelValue:P.value,"onUpdate:modelValue":l[2]||(l[2]=e=>P.value=e),duration:250,"close-on-click-modal":e.closeOnClickModal,"safe-area-inset-bottom":e.safeAreaInsetBottom,"z-index":e.zIndex,onClose:ce},{default:r((()=>[i(t,{class:"wd-calendar__header"},{default:r((()=>[e.showTypeSwitch||0!==e.shortcuts.length?v("",!0):(n(),s(t,{key:0,class:"wd-calendar__title"},{default:r((()=>[p(w(e.title||d(L)("title")),1)])),_:1})),e.showTypeSwitch?(n(),s(t,{key:1,class:"wd-calendar__tabs"},{default:r((()=>[i(Y,{ref_key:"calendarTabs",ref:ne,modelValue:K.value,"onUpdate:modelValue":l[0]||(l[0]=e=>K.value=e),onChange:me},{default:r((()=>[i(b,{title:d(L)("day"),name:d(L)("day")},null,8,["title","name"]),i(b,{title:d(L)("week"),name:d(L)("week")},null,8,["title","name"]),i(b,{title:d(L)("month"),name:d(L)("month")},null,8,["title","name"])])),_:1},8,["modelValue"])])),_:1})):v("",!0),e.shortcuts.length>0?(n(),s(t,{key:2,class:"wd-calendar__shortcuts"},{default:r((()=>[(n(!0),f(h,null,y(e.shortcuts,((e,a)=>(n(),s(x,{key:a,"custom-class":"wd-calendar__tag",type:"primary",plain:"",round:"",onClick:e=>function(e){A.onShortcutsClick&&"function"==typeof A.onShortcutsClick&&(U.value=D(A.onShortcutsClick({item:A.shortcuts[e],index:e})),J.value=fe(U.value),A.type.indexOf("range")>-1&&ve()),A.showConfirm||we()}(a)},{default:r((()=>[p(w(e.text),1)])),_:2},1032,["onClick"])))),128))])),_:1})):v("",!0),i(k,{"custom-class":"wd-calendar__close",name:"add",onClick:ce})])),_:1}),ee.value?(n(),s(t,{key:0,class:o(`wd-calendar__view  ${X.value.indexOf("range")>-1?"is-range":""} ${e.showConfirm?"is-show-confirm":""}`)},{default:r((()=>[d(de)(e.type)?(n(),s(t,{key:0,class:o("wd-calendar__range-label "+("monthrange"===e.type?"is-monthrange":""))},{default:r((()=>[i(t,{class:o("wd-calendar__range-label-item "+(U.value&&U.value[0]?"":"is-placeholder")),style:{"text-align":"right"}},{default:r((()=>[p(w(ae.value[0]),1)])),_:1},8,["class"]),i(t,{class:"wd-calendar__range-sperator"},{default:r((()=>[p("/")])),_:1}),i(t,{class:o("wd-calendar__range-label-item "+(U.value&&U.value[1]?"":"is-placeholder"))},{default:r((()=>[p(w(ae.value[1]),1)])),_:1},8,["class"])])),_:1},8,["class"])):v("",!0),i($,{ref_key:"calendarView",ref:te,modelValue:U.value,"onUpdate:modelValue":l[1]||(l[1]=e=>U.value=e),type:X.value,"min-date":e.minDate,"max-date":e.maxDate,"first-day-of-week":e.firstDayOfWeek,formatter:e.formatter,"panel-height":E.value,"max-range":e.maxRange,"range-prompt":e.rangePrompt,"allow-same-day":e.allowSameDay,"default-time":e.defaultTime,"time-filter":e.timeFilter,"hide-second":e.hideSecond,"show-panel-title":!d(de)(e.type),onChange:pe},null,8,["modelValue","type","min-date","max-date","first-day-of-week","formatter","panel-height","max-range","range-prompt","allow-same-day","default-time","time-filter","hide-second","show-panel-title"])])),_:1},8,["class"])):v("",!0),e.showConfirm?(n(),s(t,{key:1,class:"wd-calendar__confirm"},{default:r((()=>[i(M,{block:"",disabled:J.value,onClick:we},{default:r((()=>[p(w(e.confirmText||d(L)("confirm")),1)])),_:1},8,["disabled"])])),_:1})):v("",!0)])),_:1},8,["modelValue","close-on-click-modal","safe-area-inset-bottom","z-index"])])),_:3},8,["class"])}}}),[["__scopeId","data-v-8a88440f"]]);export{A as _};
