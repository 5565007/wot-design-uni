import{d as e,r as l,v as a,q as t,m as o,Q as s,o as u,c,w as d,a as i,u as r,x as n,z as m,b as v,t as p,n as f,I as h,J as V,i as _,g as y,y as k,h as w,j as x}from"./index-5b39df8e.js";import{g as z,r as b,p as g,Q as C,a as F,_ as I}from"./page-wraper.5f136bdc.js";import{_ as j}from"./demo-block.528ea9ea.js";import{_ as L}from"./wd-button.666a7a8c.js";const S=F(e({name:"wd-circle",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{modelValue:{default:0},customClass:{default:""},customStyle:{default:""},size:{default:100},color:{default:"#4d80f0"},layerColor:{default:"#EBEEF5"},fill:null,speed:{default:50},text:null,strokeWidth:{default:10},strokeLinecap:{default:"round"},clockwise:{type:Boolean,default:!0}},setup(e){const w=e;const x=2*Math.PI,F=-Math.PI/2,I=1,j=l(""),L=l(1),S=l(0),U=l(null),M=l(z());let P=null;const W=a((()=>w.size*L.value)),T=a((()=>{const e={width:b(w.size),height:b(w.size)};return`${g(e)}; ${w.customStyle}`}));t((()=>w.modelValue),(()=>{!function(){if(w.speed<=0||w.speed>1e3)return void G(w.modelValue);B(),S.value=S.value||0;const e=()=>{U.value=setTimeout((()=>{S.value!==w.modelValue?(Math.abs(S.value-w.modelValue)<I?S.value=w.modelValue:S.value<w.modelValue?S.value+=I:S.value-=I,G(S.value),e()):B()}),1e3/w.speed)};e()}()}),{immediate:!0}),t((()=>w.size),(()=>{let e=setTimeout((()=>{G(S.value),clearTimeout(e)}),50)}),{immediate:!1}),t((()=>w.color),(()=>{G(S.value)}),{immediate:!1,deep:!0}),t((()=>w.layerColor),(()=>{G(S.value)}),{immediate:!1}),t((()=>w.strokeWidth),(()=>{G(S.value)}),{immediate:!1}),t((()=>w.clockwise),(()=>{G(S.value)}),{immediate:!1}),o((()=>{S.value=w.modelValue,G(S.value)})),s((()=>{B()}));const{proxy:$}=k();function E(e,l,a,t,o){const s=w.size*L.value;let u=w.strokeWidth*L.value;const c=s/2;o||(u/=2);const d=c-u/2;e.strokeStyle=l,e.setLineWidth(u),e.setLineCap(w.strokeLinecap),e.beginPath(),e.arc(c,c,d,a,t,!w.clockwise),e.stroke(),o&&(e.setLineWidth(u),e.setFillStyle(o),e.fill())}function G(e){const l=w.size*L.value;(P||(P=h(M.value,$)),Promise.resolve(P)).then((a=>{a.clearRect(0,0,l,l),function(e){E(e,w.layerColor,0,x,w.fill)}(a);const t=(o=e,Math.min(Math.max(o,0),100));var o;0!==t?function(e,l){const a=w.size*L.value,t=x*(l/100),o=w.clockwise?F+t:3*Math.PI-(F+t);if(C(w.color)){const l=e.createLinearGradient(a,0,0,0);Object.keys(w.color).sort(((e,l)=>parseFloat(e)-parseFloat(l))).map((e=>l.addColorStop(parseFloat(e)/100,w.color[e]))),j.value=l}else j.value=w.color;E(e,j.value,F,o)}(a,t):function(e){const l=w.size*L.value,a=w.strokeWidth*L.value,t=l/2;if(C(w.color)){const a=e.createLinearGradient(l,0,0,0);Object.keys(w.color).sort(((e,l)=>parseFloat(e)-parseFloat(l))).map((e=>a.addColorStop(parseFloat(e)/100,w.color[e]))),j.value=a}else j.value=w.color;e.beginPath(),e.arc(t,a/4,a/4,0,x),e.setFillStyle(j.value),e.fill()}(a),a.draw()}))}function B(){U.value&&clearTimeout(U.value)}return(l,a)=>{const t=V,o=_,s=y;return u(),c(o,{class:f(`wd-circle ${e.customClass}`)},{default:d((()=>[i(t,{width:r(W),height:r(W),style:n(r(T)),id:M.value,"canvas-id":M.value},null,8,["width","height","style","id","canvas-id"]),e.text?(u(),c(s,{key:1,class:"wd-circle__text"},{default:d((()=>[v(p(e.text),1)])),_:1})):(u(),c(o,{key:0,class:"wd-circle__text"},{default:d((()=>[m(l.$slots,"default",{},void 0,!0)])),_:3}))])),_:3},8,["class"])}}}),[["__scopeId","data-v-9b364275"]]),U=F(e({__name:"Index",setup(e){const a=l(20),t={0:"red",100:"white"};function o(){a.value<100&&(a.value+=10)}function s(){a.value>0&&(a.value-=10)}return(e,l)=>{const r=w(x("wd-circle"),S),n=w(x("demo-block"),j),m=_,f=w(x("wd-button"),L),h=w(x("page-wraper"),I);return u(),c(m,{class:"circle"},{default:d((()=>[i(h,null,{default:d((()=>[i(n,{title:"基础用法"},{default:d((()=>[i(r,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),text:a.value+"%"},null,8,["modelValue","text"])])),_:1}),i(n,{title:"样式定制"},{default:d((()=>[i(r,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value=e),"stroke-width":6,text:"宽度定制"},null,8,["modelValue"]),i(r,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[2]||(l[2]=e=>a.value=e),"layer-color":"#eee",color:"#ee0a24",text:"颜色定制"},null,8,["modelValue"]),i(r,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[3]||(l[3]=e=>a.value=e),color:t,text:"渐变色"},null,8,["modelValue"]),i(r,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[4]||(l[4]=e=>a.value=e),color:"#07c160",clockwise:!1,text:"逆时针"},null,8,["modelValue"]),i(r,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[5]||(l[5]=e=>a.value=e),size:120,text:"大小定制"},null,8,["modelValue"])])),_:1}),i(n,{title:"使用slot"},{default:d((()=>[i(r,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[6]||(l[6]=e=>a.value=e),"stroke-width":6},{default:d((()=>[i(m,{style:{color:"red"}},{default:d((()=>[v(p(a.value)+"%",1)])),_:1})])),_:1},8,["modelValue"])])),_:1}),i(n,null,{default:d((()=>[i(f,{"custom-style":"margin-right:24rpx",type:"primary",size:"small",onClick:o},{default:d((()=>[v("增加")])),_:1}),i(f,{type:"error",size:"small",onClick:s},{default:d((()=>[v("减少")])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-d552201c"]]);export{U as default};
